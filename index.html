<!DOCTYPE html>
<html lang="es">
<head>
    <link rel="stylesheet" href="Style.css">
    <meta charset="UTF-8">
    <title>Xcelentric - Calculadora Financiera Pro</title>

</head>

<body>
<div class="container">
<div class="header-title">
    <div class="title-logo-left">
        <img src="Logo Xcelentric.png" alt="Logo Xcelentric">
    </div>

<div class="title-text">
    Calculadora de Rentabilidad Xcelentric
</div>

    <div class="title-logo-right">
        <img src="https://xcelentric.com/wp-content/uploads/2024/08/abeja_v5-300x280.png" alt="Logo Abeja">
    </div>
</div>
<!-- ================= RESUMEN PRINCIPAL – MODELOS DE INGRESO ================= -->
<div class="summary-box">
    <h3>¿CÓMO GENERA DINERO LA COMPRA DE CARGADORES?</h3>

<div class="scenario-section-box">
    <h3 class="scenario-title">Número de Cargadores</h3>
    <div class="scenario-controls">
        <div class="sc-item">
            <span class="sc-label">Pesimista</span>
            <button onclick="stepScenario('p',-1)">−</button>
            <input id="ctrl_p" type="number" value="2" min="1" max="12" oninput="syncScenario('p',this.value)">
            <button onclick="stepScenario('p',1)">+</button>
        </div>

        <div class="sc-item">
            <span class="sc-label">Base</span>
            <button onclick="stepScenario('b',-1)">−</button>
            <input id="ctrl_b" type="number" value="4" min="1" max="12" oninput="syncScenario('b',this.value)">
            <button onclick="stepScenario('b',1)">+</button>
        </div>

        <div class="sc-item">
            <span class="sc-label">Optimista</span>
            <button onclick="stepScenario('o',-1)">−</button>
            <input id="ctrl_o" type="number" value="6" min="1" max="12" oninput="syncScenario('o',this.value)">
            <button onclick="stepScenario('o',1)">+</button>
        </div>
    </div>
</div>
<div class="summary-header">
    <small class="currency-label">TIPO DE MONEDA: MXN</small>
</div>
    <div class="triple-summary">

        <!-- ESCENARIO 1 -->
        <div class="summary-card">
            <h4>1. Venta de Electricidad</h4>
            <p class="desc">Flujo mensual recurrente por uso de cargadores</p>

            <table>
                <tr><th>PESIMISTA</th><th>BASE</th><th>OPTIMISTA</th></tr>
                <tr>
                    <td id="kpi_u_p">$0</td>
                    <td id="kpi_u_b">$0</td>
                    <td id="kpi_u_o">$0</td>
                </tr>
            </table>
        </div>

        <!-- ESCENARIO 2 -->
        <div class="summary-card highlight">
            <h4>2. Plusvalía del Activo (Exit)</h4>
            <p class="desc">Incremento del valor del estacionamiento equipado</p>

            <table>
                <tr><th>PESIMISTA</th><th>BASE</th><th>OPTIMISTA</th></tr>
                <tr>
                    <td id="kpi_x_p">$0</td>
                    <td id="kpi_x_b">$0</td>
                    <td id="kpi_x_o">$0</td>
                </tr>
            </table>

            <small>
                Inversión inicial: <span id="pv_inv_b"></span> ·
                Horizonte: <span id="pv_t_b"></span>
            </small>
        </div>

        <!-- ESCENARIO 3 -->
        <div class="summary-card">
            <h4>3. Comisiones y Referidos</h4>
            <p class="desc">Ingresos paralelos por red comercial</p>

            <table>
                <tr><th>PESIMISTA</th><th>BASE</th><th>OPTIMISTA</th></tr>
                <tr>
                    <td id="kpi_c_p">$0</td>
                    <td id="kpi_c_b">$0</td>
                    <td id="kpi_c_o">$0</td>
                </tr>
            </table>
        </div>

    </div>
</div>
<!-- Contenedor del gráfico -->
<div class="grafico-box">
    <canvas id="graficaGanancias"></canvas>
</div>
    <button class="reset-btn" onclick="resetEditable()">Resetear valores</button>
    <!-- ================= RESUMEN ESTRATÉGICO DEL COMPRADOR ================= -->

<hr class="table-divider">
<table class="main-table">
        <thead>
            <tr class="big-divider">
                <td colspan="5">1. VENTA DE ELECTRICIDAD</td>
            </tr>
            <tr>
                <th>CONCEPTO</th>
                <th>ESCENARIO PESIMISTA</th>
                <th>ESCENARIO BASE</th>
                <th>ESCENARIO OPTIMISTA</th>
                <th>UNIDAD / LÓGICA</th>
            </tr>
        </thead>
        <tbody>
            <tr class="sec"><td colspan="5">1. PREMISAS DE VENTA</td></tr>
            <tr><td class="lbl">Número de Cargadores</td><td><input type="number" id="v1_p" class="edit" value="2"></td><td><input type="number" id="v1_b" class="edit" value="4"></td><td><input type="number" id="v1_o" class="edit" value="6"></td><td>Unidades</td></tr>
            <tr><td class="lbl">Porcentaje de utilización</td>
                <td><input id="v2_p" class="read" value="3%"></td>
                <td><input id="v2_b" class="read" value="5%"></td>
                <td><input id="v2_o" class="read" value="7%"></td><td>horas uso</td></tr>
            <tr><td class="lbl">Venta mensual x cargador (kWh)</td>
                <td><input type="number" id="v3_p" class="read" value="500"></td>
                <td><input type="number" id="v3_b" class="read" value="1000"></td>
                <td><input type="number" id="v3_o" class="read" value="1500"></td><td>kWh/mes</td></tr>
            <tr><td class="lbl">Precio de venta (PVP)</td><td><input type="number" id="v4_p" class="edit" value="7.90"></td><td><input type="number" id="v4_b" class="edit" value="8.90"></td><td><input type="number" id="v4_o" class="edit" value="9.90"></td><td>MXN/kWh</td></tr>
            <tr><td class="lbl">Costo de compra electricidad</td><td><input type="number" id="v5_p" class="edit" value="4.90"></td><td><input type="number" id="v5_b" class="edit" value="3.90"></td><td><input type="number" id="v5_o" class="edit" value="2.90"></td><td>MXN/kWh</td></tr>
            <tr><td class="lbl">Margen simple por electricidad</td><td><input id="v6_p" class="read"></td><td><input id="v6_b" class="read"></td><td><input id="v6_o" class="read"></td><td>%</td></tr>
            <tr><td class="lbl">Ajuste precios por inflación</td>
                <td><input id="v7_p" class="read" value="6%"></td>
                <td><input id="v7_b" class="read" value="4%"></td>
                <td><input id="v7_o" class="read" value="3%"></td><td>% anual</td></tr>
            <tr><td class="lbl">Crecimiento vehículos enchufables</td>
                <td><input id="v8_p" class="read" value="4%"></td>
                <td><input id="v8_b" class="read" value="6%"></td>
                <td><input id="v8_o" class="read" value="8%"></td><td>vs. Año anterior</td></tr>
            <tr><td class="lbl">Periodo de amortización</td>
                <td><input id="v9_p" class="read" value="60"></td>
                <td><input id="v9_b" class="read" value="60"></td>
                <td><input id="v9_o" class="read" value="60"></td><td>Meses</td></tr>
            <tr class="total"><td class="lbl">SUBTOTAL INGRESOS ELECTRICIDAD</td><td><input id="v10_p" class="read"></td><td><input id="v10_b" class="read"></td><td><input id="v10_o" class="read"></td><td>Venta Energía</td></tr>

            <tr class="sec"><td colspan="5">2. GASTOS FIJOS (CAPEX)</td></tr>
            <tr><td class="lbl">Instalación (Obra/Cableado)</td><td><input type="number" id="c1_p" class="edit" value="20000"></td><td><input type="number" id="c1_b" class="edit" value="30000"></td><td><input type="number" id="c1_o" class="edit" value="40000"></td><td>Inversión</td></tr>
            <tr><td class="lbl">Permisos y Licencias</td>
                <td><input id="c2_p" class="read" value="4000"></td>
                <td><input id="c2_b" class="read" value="4000"></td>
                <td><input id="c2_o" class="read" value="4000"></td><td>Inversión</td></tr>
            <tr><td class="lbl">Pintura y Señalización</td>
                <td><input id="c3_p" class="read" value="1000"></td>
                <td><input id="c3_b" class="read" value="1000"></td>
                <td><input id="c3_o" class="read" value="1000"></td><td>Inversión</td></tr>
            <tr><td class="lbl">Equipos de Recarga (Adquisición)</td><td><input type="number" id="c4_p" class="edit" value="30000"></td><td><input type="number" id="c4_b" class="edit" value="60000"></td><td><input type="number" id="c4_o" class="edit" value="120000"></td><td>$15k x ud</td></tr>
            <tr><td class="lbl">Publicidad Inicial</td>
                <td><input id="c5_p" class="read" value="2000"></td>
                <td><input id="c5_b" class="read" value="4000"></td>
                <td><input id="c5_o" class="read" value="6000"></td><td>Inversión</td></tr>
            <tr><td class="lbl">Formación de Personal / Otros</td>
                <td><input id="c6_p" class="read" value="1000"></td>
                <td><input id="c6_b" class="read" value="1000"></td>
                <td><input id="c6_o" class="read" value="1000"></td><td>Inversión</td></tr>
            <tr><td class="lbl">Impuestos y gravamenes</td><td><input type="number" id="c7_p" class="edit" value="0"></td><td><input type="number" id="c7_b" class="edit" value="0"></td><td><input type="number" id="c7_o" class="edit" value="0"></td><td>Fiscal</td></tr>
            <tr><td class="lbl">Depreciación fiscal (20%)</td><td><input id="c8_p" class="read"></td><td><input id="c8_b" class="read"></td><td><input id="c8_o" class="read"></td><td>Anual</td></tr>
            <tr><td class="lbl">Subsidios aplicables</td><td><input type="number" id="c9_p" class="edit" value="0"></td><td><input type="number" id="c9_b" class="edit" value="0"></td><td><input type="number" id="c9_o" class="edit" value="0"></td><td>% subvención</td></tr>
            <tr class="total"><td class="lbl">TOTAL INVERSIÓN INICIAL</td><td><input id="c10_p" class="read"></td><td><input id="c10_b" class="read"></td><td><input id="c10_o" class="read"></td><td>CAPEX</td></tr>
            <tr><td class="lbl">Amortización Mensual</td><td><input id="c11_p" class="read"></td><td><input id="c11_b" class="read"></td><td><input id="c11_o" class="read"></td><td>Gasto mes</td></tr>

            <tr class="sec"><td colspan="5">3. GASTOS OPERATIVOS (OPEX)</td></tr>
            <tr><td class="lbl">Royalties Xcelentric (Fijo)</td>
                <td><input id="o1_p" class="read" value="580"></td>
                <td><input id="o1_b" class="read" value="1160"></td>
                <td><input id="o1_o" class="read" value="1740"></td><td>$290/mes x ud</td></tr>
            <tr><td class="lbl">Mantenimiento Preventivo</td>
                <td><input id="o2_p" class="read" value="100"></td>
                <td><input id="o2_b" class="read" value="200"></td>
                <td><input id="o2_o" class="read" value="300"></td><td>$50/mes x ud</td></tr>
            <tr><td class="lbl">Mantenimiento Correctivo</td>
                <td><input id="o3_p" class="read" value="100"></td>
                <td><input id="o3_b" class="read" value="200"></td>
                <td><input id="o3_o" class="read" value="800"></td><td>Mensual</td></tr>
            <tr><td class="lbl">Seguro Civil y Vandalismo</td>
                <td><input type="number" id="o4_p" class="edit" value="0"></td>
                <td><input type="number" id="o4_b" class="edit" value="0"></td>
                <td><input type="number" id="o4_o" class="edit" value="0"></td><td>Provisión</td></tr>
            <tr><td class="lbl">Publicidad Recurrente</td>
                <td><input id="o5_p" class="read" value="400"></td>
                <td><input id="o5_b" class="read" value="600"></td>
                <td><input id="o5_o" class="read" value="800"></td><td>Mensual</td></tr>
            <tr><td class="lbl">Transacciones Bancarias</td>
                <td><input type="number" id="o6_p" class="edit" value="0"></td>
                <td><input type="number" id="o6_b" class="edit" value="0"></td>
                <td><input type="number" id="o6_o" class="edit" value="0"></td><td>Comisiones</td></tr>
            <tr><td class="lbl">Tarjetas RFID</td>
                <td><input id="o7_p" class="read" value="150"></td>
                <td><input id="o7_b" class="read" value="200"></td>
                <td><input id="o7_o" class="read" value="300"></td><td>Mensual</td></tr>
            <tr><td class="lbl">Conectividad (SIM card)</td>
                <td><input id="o8_p" class="read" value="160"></td>
                <td><input id="o8_b" class="read" value="320"></td>
                <td><input id="o8_o" class="read" value="480"></td><td>$80/mes x ud</td></tr>
            <tr><td class="lbl">ISR y retenciones fiscales</td>
                <td><input type="number" id="o9_p" class="edit" value="0"></td>
                <td><input type="number" id="o9_b" class="edit" value="0"></td>
                <td><input type="number" id="o9_o" class="edit" value="0"></td><td>Mensual</td></tr>
            <tr class="total"><td class="lbl">TOTAL OPEX FIJO MENSUAL</td><td><input id="o10_p" class="read"></td><td><input id="o10_b" class="read"></td><td><input id="o10_o" class="read"></td><td>Sin energía</td></tr>

            <tr class="sec"><td colspan="5">4. INGRESOS EXTRA (EXPLOTACIÓN)</td></tr>
            <tr><td class="lbl">Publicidad in-situ</td>
                <td><input id="e1_p" class="read" value="500"></td>
                <td><input id="e1_b" class="read" value="1200"></td>
                <td><input id="e1_o" class="read" value="2500"></td><td>Por ubicación</td></tr>
            <tr><td class="lbl">Membresías VIP (Suscripción)</td>
                <td><input id="e2_p" class="read" value="300"></td>
                <td><input id="e2_b" class="read" value="800"></td>
                <td><input id="e2_o" class="read" value="1500"></td><td>Fijo mensual</td></tr>
            <tr><td class="lbl">Tarifas de Ocupación (Idle fees)</td>
                <td><input id="e3_p" class="read" value="150"></td>
                <td><input id="e3_b" class="read" value="350"></td>
                <td><input id="e3_o" class="read" value="700"></td><td>Por exceso</td></tr>
            <tr><td class="lbl">Generación de Leads / Cupones</td>
                <td><input id="e4_p" class="read" value="100"></td>
                <td><input id="e4_b" class="read" value="250"></td>
                <td><input id="e4_o" class="read" value="600"></td><td>Alianzas</td></tr>
            <tr><td class="lbl">Créditos de Carbono (Mensual)</td>
                <td><input id="e5_p" class="read" value="50"></td>
                <td><input id="e5_b" class="read" value="150"></td>
                <td><input id="e5_o" class="read" value="300"></td><td>Bonos CO2</td></tr>
            <tr class="total"><td class="lbl">SUBTOTAL INGRESOS EXTRA</td><td><input id="e6_p" class="read"></td><td><input id="e6_b" class="read"></td><td><input id="e6_o" class="read"></td><td>Extra Total</td></tr>

            <tr class="sec"><td colspan="5">5. RENTABILIDAD MENSUAL</td></tr>
            <tr><td class="lbl">INGRESOS TOTALES</td><td><input id="r1_p" class="read"></td><td><input id="r1_b" class="read"></td><td><input id="r1_o" class="read"></td><td>Carga + Extra</td></tr>
            <tr><td class="lbl">Costo de Energía (Suministro)</td><td><input id="r2_p" class="read"></td><td><input id="r2_b" class="read"></td><td><input id="r2_o" class="read"></td><td>kWh * Costo</td></tr>
            <tr><td class="lbl">Royalty Variable Energía (15%)</td><td><input id="r3_p" class="read"></td><td><input id="r3_b" class="read"></td><td><input id="r3_o" class="read"></td><td>s/Ingreso Energía</td></tr>
            <tr class="net-row"><td class="lbl">UTILIDAD NETA MENSUAL</td><td><input id="r4_p" class="read"></td><td><input id="r4_b" class="read"></td><td><input id="r4_o" class="read"></td><td>GANANCIA REAL</td></tr>
            <!-- --- -->

        
        </tbody>
    </table>

<hr class="table-divider">

<table class="main-table">
        <thead>
            <tr class="big-divider">
                <td colspan="5">2. RESULTADOS ESTRATÉGICOS Y CRECIMIENTO</td>
            </tr>
            <tr>
                <th>CONCEPTO</th>
                <th>ESCENARIO PESIMISTA</th>
                <th>ESCENARIO BASE</th>
                <th>ESCENARIO OPTIMISTA</th>
                <th>UNIDAD / LÓGICA</th>
            </tr>
        </thead>
        <tbody>
                        <!-- 6. ESCALABILIDAD A 10 CARGADORES -->
            <tr class="sec"><td colspan="5">6. ESCALABILIDAD A 10 CARGADORES</td></tr>
            <tr>
                <td class="lbl">Inversión Extra (para llegar a 10 equipos)</td>
                <td><input type="number" id="v6_1_p" class="edit" value="120000"></td>
                <td><input type="number" id="v6_1_b" class="edit" value="90000"></td>
                <td><input type="number" id="v6_1_o" class="edit" value="30000"></td>
                <td>CAPEX expansión</td>
            </tr>
            <tr>
                <td class="lbl">Utilidad Neta Mes (10 Unidades)</td>
                <td><input id="v6_2_p" class="read"></td>
                <td><input id="v6_2_b" class="read"></td>
                <td><input id="v6_2_o" class="read"></td>
                <td>Escalamiento total</td>
            </tr>
            <tr>
                <td class="lbl">Año Óptimo Escalabilidad</td>
                <td><input id="v6_3_p" class="read"></td>
                <td><input id="v6_3_b" class="read"></td>
                <td><input id="v6_3_o" class="read"></td>
                <td></td>
            </tr>

            <!-- 7. ACUMULADOS Y REINVERSIÓN -->
            <tr class="sec"><td colspan="5">7. ACUMULADOS Y REINVERSIÓN (5 AÑOS)</td></tr>
            <tr>
                <td class="lbl">Acumulado Simple (5 años)</td>
                <td><input id="v7_1_p" class="read"></td>
                <td><input id="v7_1_b" class="read"></td>
                <td><input id="v7_1_o" class="read"></td>
                <td>Flujo caja neto</td>
            </tr>
            <tr>
                <td class="lbl">Reinversión (7% Anual Compuesto)</td>
                <td><input id="v7_2_p" class="read"></td>
                <td><input id="v7_2_b" class="read"></td>
                <td><input id="v7_2_o" class="read"></td>
                <td></td>
            </tr>

            <!-- 8. EXIT -->
            <tr class="sec"><td colspan="5">8. VALUACIÓN DE VENTA (EXIT)</td></tr>
            <tr>
                <td class="lbl">VALOR CONTRATO (7 AÑOS)</td>
                <td><input id="v8_1_p" class="read"></td>
                <td><input id="v8_1_b" class="read"></td>
                <td><input id="v8_1_o" class="read"></td>
                <td>Mínimo a negociar</td>
            </tr>
            <tr>
                <td class="lbl">Múltiplo de Salida (EBITDA)</td>
                <td><input id="v8_2_p" class="read" value="3"></td>
                <td><input id="v8_2_b" class="read" value="5"></td>
                <td><input id="v8_2_o" class="read" value="7"></td>
                <td>Múltiplo mercado</td>
            </tr>
            <tr>
                <td class="lbl">PRECIO VENTA NEGOCIO (EXIT)</td>
                <td><input id="v8_3_p" class="read"></td>
                <td><input id="v8_3_b" class="read"></td>
                <td><input id="v8_3_o" class="read"></td>
                <td>Valuación base</td>
            </tr>
            <tr>
                <td class="lbl">Plus por Escalabilidad</td>
                <td><input id="v8_4_p" class="read"></td>
                <td><input id="v8_4_b" class="read"></td>
                <td><input id="v8_4_o" class="read"></td>
                <td>Valor estratégico</td>
            </tr>
            <tr class="total">
                <td class="lbl">VALUACIÓN FINAL EXIT</td>
                <td><input id="v8_5_p" class="read"></td>
                <td><input id="v8_5_b" class="read"></td>
                <td><input id="v8_5_o" class="read"></td>
                <td>PRECIO DE SALIDA</td>
            </tr>
            <!-- 9. VALOR POR PLAZA (100k inicial) -->
            <tr class="sec"><td colspan="5">9. VALOR POR PLAZA (100k inicial)</td></tr>
            <tr>
            <td class="lbl">TIR Proyecto (5 años)</td>
            <td><input id="v9_1_p" class="read"></td>
            <td><input id="v9_1_b" class="read"></td>
            <td><input id="v9_1_o" class="read"></td>
            <td></td>
            </tr>
            <tr>
            <td class="lbl">Tiempo de retorno</td>
            <td><input id="v9_2_p" class="read"></td>
            <td><input id="v9_2_b" class="read"></td>
            <td><input id="v9_2_o" class="read"></td>
            <td></td>
            </tr>
            <tr>
            <td class="lbl">Valor Inicial</td>
            <td><input id="v9_3_p" class="read"></td>
            <td><input id="v9_3_b" class="read"></td>
            <td><input id="v9_3_o" class="read"></td>
            <td>100K por plaza - parking vacío</td>
            </tr>
            <tr>
            <td class="lbl">Valor Final x Plaza Equipada</td>
            <td><input id="v9_4_p" class="read"></td>
            <td><input id="v9_4_b" class="read"></td>
            <td><input id="v9_4_o" class="read"></td>
            <td>Venta por unidad</td>
            </tr>
            <tr class="total">
            <td class="lbl">PLUSVALÍA GENERADA (x veces)</td>
            <td><input id="v9_5_p" class="read"></td>
            <td><input id="v9_5_b" class="read"></td>
            <td><input id="v9_5_o" class="read"></td>
            <td></td>
            </tr>
        
        </tbody>
    </table>
<hr class="table-divider">
<table class="main-table">
        <thead>
            <tr class="big-divider">
                <td colspan="5">3. COMISIONES</td>
            </tr>    
            <tr>
                <th>CONCEPTO</th>
                <th>ESCENARIO PESIMISTA</th>
                <th>ESCENARIO BASE</th>
                <th>ESCENARIO OPTIMISTA</th>
                <th>UNIDAD / LÓGICA</th>
            </tr>
        </thead>
        <tbody>
            <!-- 10. COMISIONES DE VENTAS GENERADAS -->
            <tr class="sec"><td colspan="5">10. COMISIONES DE VENTAS GENERADAS</td></tr>
            <tr>
            <td class="lbl">Comisión Fija (Cargadores Propios)</td>
            <td><input id="v10_1_p" class="read"></td>
            <td><input id="v10_1_b" class="read"></td>
            <td><input id="v10_1_o" class="read"></td>
            <td>$500 * Núm_Cargadores</td>
            </tr>
            <tr>
            <td class="lbl">Com. Variable kWh (2% s/Venta)</td>
            <td><input id="v10_2_p" class="read"></td>
            <td><input id="v10_2_b" class="read"></td>
            <td><input id="v10_2_o" class="read"></td>
            <td>2% de Ingresos</td>
            </tr>
            <tr>
            <td class="lbl">Estimado de Cargadores Referidos</td>
            <td><input id="v10_3_p" class="read"></td>
            <td><input id="v10_3_b" class="read"></td>
            <td><input id="v10_3_o" class="read"></td>
            <td>Unidades externas</td>
            </tr>
            <tr>
            <td class="lbl">Com. Referidos</td>
            <td><input id="v10_4_p" class="read"></td>
            <td><input id="v10_4_b" class="read"></td>
            <td><input id="v10_4_o" class="read"></td>
            <td>$200 * cargador de Venta de Terceros</td>
            </tr>
            <tr class="total">
            <td class="lbl">TOTAL COMISIONES MES</td>
            <td><input id="v10_5_p" class="read"></td>
            <td><input id="v10_5_b" class="read"></td>
            <td><input id="v10_5_o" class="read"></td>
            <td>La fija se amortiza</td>
            </tr>
        
        </tbody>
    </table>

</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="graf.js"></script>
<script src="main.js"></script>
</body>
</html>

